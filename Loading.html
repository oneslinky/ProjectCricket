<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Loading</title>
        <link rel="stylesheet" href="StyleSheet.css">
        <link rel="icon" type="image/x-icon" href="https://raw.github.com/oneslinky/ProjectCricket/76f773d4979e9031c0e8b017f510a429897650b2/assests/favicon/Favicon%20Black%20Background%20Square.png">


        <script>
            function upload(){
                const progressBar = document.getElementById('progressBar');
                const goNextBtn = document.getElementById('goNextBtn');
                const generateBtn = document.getElementById('generateBtn');

                goNextBtn.disabled = true;
                generateBtn.disabled = true;
                let progress = 0;
                progressBar.style.width = '0%';
                progressBar.textContent = '0%';
                const interval = setInterval(() => {
                    progress += Math.floor(Math.random() * 6) + 1;
                    if(progress > 100) progress = 100;
                    progressBar.style.width = progress + '%';
                    progressBar.textContent = progress + '%';

                    if(progress >= 100){
                        clearInterval(interval);
                        goNextBtn.disabled = false;
                        generateBtn.disabled = true;
                        progressBar.classList.add('complete');
                    }
                }, 75);
            }
        </script>

        <script>
        (function(){
            const backgrounds = [
                'https://raw.github.com/oneslinky/ProjectCricket/76f773d4979e9031c0e8b017f510a429897650b2/assests/loading%20background/Alleyway%20(Noir).png',
                'https://raw.github.com/oneslinky/ProjectCricket/76f773d4979e9031c0e8b017f510a429897650b2/assests/loading%20background/Cityscape.png',
                'https://raw.github.com/oneslinky/ProjectCricket/76f773d4979e9031c0e8b017f510a429897650b2/assests/loading%20background/Rooftop%20(Comic).png'
            ];

            function pickRandom(arr){ return arr[Math.floor(Math.random() * arr.length)]; }

            function setBackground(src){
                const img = new Image();
                img.onload = function(){
                    const css = `url("${src}")`;
                    document.documentElement.style.backgroundImage = css;
                    document.body.style.backgroundImage = css;
                };
                img.onerror = function(){
                    const idx = backgrounds.indexOf(src);
                    if(idx > -1) backgrounds.splice(idx,1);
                    if(backgrounds.length) setBackground(pickRandom(backgrounds));
                    else {
                        const grad = 'linear-gradient(120deg,#0f1724,#0b3a53)';
                        document.documentElement.style.backgroundImage = grad;
                        document.body.style.backgroundImage = grad;
                    }
                };
                img.src = src;
            }

            document.addEventListener('DOMContentLoaded', function(){
                if(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches){
                    document.documentElement.style.transition = 'none';
                }
                setBackground(pickRandom(backgrounds));
            });
        })();
        </script>
    </head>
    <body class="bg-contain">
        <header class="top-header">
            <div class="inner">
                <h1><strong>Loading</strong></h1>
                <div class="header-controls">
                    <div class="progress-track">
                        <div id="progressBar" class="progress-bar">0%</div>
                    </div>
                    <div class="header-buttons">
                        <button id="generateBtn" onclick="upload()">Generate Simulation</button>
                        <button id="goNextBtn" disabled>Go Next</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main content sits below the header so the background image is cropped under the header area -->
        <main>
            <div style="text-align:center; margin-top: 3rem;">
                <!-- optional content below header -->
            </div>
        </main>

        <div id="goNextConfirm" class="overlay" style="display:none; position:fixed; inset:0; align-items:center; justify-content:center;">
            <div class="popup" style="background:#cd04fa; padding:1.5rem; border-radius:8px; max-width:400px; text-align:center;">
                <h2>Are you ready to proceed to the simulation?</h2>
                <p>There is no other option</p>
                <button id="confirmGoNext">Yes, Proceed</button>
            </div>
        </div>

        <script>
            document.getElementById('goNextBtn').addEventListener('click', function(){
                document.getElementById('goNextConfirm').style.display = 'flex';
            });
            document.getElementById('confirmGoNext').addEventListener('click', function(){
                window.location.href = 'Simulation.html';
            });
        </script>
    </body>
</html>